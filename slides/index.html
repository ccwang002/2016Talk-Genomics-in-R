<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Genomics in R</title>
	<meta name="viewport" content="width=792, user-scalable=no">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<!-- Icon -->
	<link href="pics/twR_logo.png" rel="icon" type="image/x-icon" />
	<!-- CSS Stle -->
	<link rel="stylesheet" href="lib/shower/themes/styles/screen-16x10.css">
	<link rel="stylesheet" href="lib/highlight/styles/github.css" type="text/css"/>
	<style>
		.caption p {
			font-size: 0.6em;
		}
		.slide.mid h2 {
			font-size: 110px;
			font-family: Roboto Light;
			font-weight: 300;
			color: white;
			width: 65%;
			line-height: 1.25em;
			text-shadow: 1px 1px 3px black;
		}
		.citation pre {
			text-align: left;
		}
		pre.medium {
			font-size: 0.75em;
		}
		pre.medium code {
			line-height: 1.5em;
		}
		pre.small {
			font-size: 0.5em;
		}
		pre.small code {
			line-height: 1.5em;
		}

		.sidenote {
			border: 2px dashed #9e9e9e;
			position: absolute;
			padding: 1em;
			line-height: 1.5em;
			color: #9e9e9e;
		}
		.sidenote p {
			margin-bottom: 0px;
		}

	</style>
</head>
<body class="shower list">
	<!-- Header in overview -->
	<header class="caption">
		<h1>Genomics in R</h1>
		<p><a href="http://liang2.tw">Liang-Bo Wang (亮亮)</a>, 2016-05-16</p>
	</header>

	<!-- Cover Slide -->
	<section id="cover" class="slide no-number">
		<h2 id="talk-header">Genomics in R</h2>
		<p id="talk-author">
			By <a href="http://liang2.tw" target="_blank">Liang<sup>2</sup></a> under CC 4.0 BY license
		</p>
		<p id="usage-instr">
			<kbd>Esc</kbd> to overview <br />
			<kbd>←</kbd> <kbd>→</kbd> to navigate
		</p>
		<img src="pics/cover.jpg" class="cover w" alt="">
		<style>
			#talk-header,
			#talk-author {
				left: 56px;
			}
			#talk-header {
				color: #EEE;
				text-align: left;
				font-size: 100px;
				line-height: 1.3em;
				text-shadow: -1px 1px 3px #000;
				bottom: 160px;
				position: absolute;

			}
			#talk-author {
				line-height: 1.2em;
				text-shadow: -1px 1px 3px #000;
				left: 65px;
				bottom: 120px;
				position: absolute;
			}
			#talk-author a {
				color: #FFFA20;
			}
			#cover p {
				margin: 10px 0 0;
				color: #FFF;
				font-size: 32px;
				opacity: 1;
			}
			#usage-instr {
				position: absolute;
				text-align: right;
				right: 30px;
				bottom: 40px;
			}
			#usage-instr kbd {
				opacity: 0.8;
				color: #666;
				background-color: white;
			}
			#cover img {
				opacity: 0.95;
			}
			#cover {
				background: black;
			}
		</style>
	</section>

	<!-- Proposed Outline -->
	<!--
	- A very quick guide to genome, sequencing, genomic annotation and genome browser
	- Bioconductor introduction
	- Annotation and genome reference (OrgDb, TxDb, OrganismDb, BSgenome)
	- Operations on genome (GenomicRanges)
	- Experiment data storage (ExpressionSets) (optional, if we have time)
	-->

	<!-- Reading List
	Bioconductor cheat sheet
	https://github.com/mikelove/bioc-refcard/blob/master/README.Rmd

	Annotation
	https://www.bioconductor.org/help/workflows/annotation/Annotation_Resources/
	https://www.bioconductor.org/help/course-materials/2015/Uruguay2015/V4-Annotation.html
	https://www.bioconductor.org/help/course-materials/2015/BioC2015/Annotation_Resources.html
	http://genomicsclass.github.io/book/pages/bioc1_annoCheat.html
	http://genomicsclass.github.io/book/pages/bioc1_annoOverview.html

	Genome Ranges
	http://genomicsclass.github.io/book/pages/bioc1_igranges.html
	http://genomicsclass.github.io/book/pages/bioc1_grangeOps.html
	https://www.bioconductor.org/packages/release/bioc/vignettes/GenomicRanges/inst/doc/GenomicRangesIntroduction.pdf
	http://genomicsclass.github.io/book/pages/iranges_granges.html
	http://genomicsclass.github.io/book/pages/operateGRanges.html
	https://www.bioconductor.org/help/course-materials/2015/Uruguay2015/V3-GenomicRanges.html
	http://bioconductor.org/packages/release/bioc/vignettes/GenomicRanges/inst/doc/GRanges_and_GRangesList_slides.pdf

	Sequence Analysis
	https://www.bioconductor.org/help/course-materials/2015/EMBO/A01_RBiocForSequenceAnalysis.html
	-->


	<!-- Section: Bioconductor -->
	<section class="slide mid no-number">
		<h2>Bioconductor</h2>
		<img src="pics/mid.jpg" class="cover w" alt="">
	</section>

	<section id="bioc-setup" class="slide">
	<h2>R environment setup</h2>
		<pre class="language-r">
<code>source("https://bioconductor.org/biocLite.R")
biocLite()   # install fundamental packages
biocLite(c(  # packages required for today's demo
    "Homo.sapiens",
    "BSgenome.Hsapiens.UCSC.hg19",
))
install.packages(c("devtools", "stringr", "plyr"))</code>
		</pre>
	</section>


	<!-- Section: Annotation Resources -->
	<section id="sec-annotation-resources" class="slide mid no-number">
		<h2>Annotation Resources</h2>
		<img src="pics/mid.jpg" class="cover w" alt="">
	</section>

	<section class="slide">
		<h2>Annotation Sources in Bioconductor</h2>
		<table class="striped">
		<thead>
			<tr>
				<th>Object Type</th>
				<th>Example Package Name</th>
			</tr>
		</thead>
		<tbody>
		<tr>
			<th role="row">OrgDb</th>
			<td>
				<a href="http://bioconductor.org/packages/org.Hs.eg.db/">
					org.Hs.eg.db
				</a>
			</td>
		</tr>
		<tr>
			<th role="row">TxDb</th>
			<td>
				<a href="http://bioconductor.org/packages/TxDb.Hsapiens.UCSC.hg19.knownGene/">
					TxDb.Hsapiens.UCSC.hg19.knownGene
				</a>
			</td>
		</tr>
		<tr>
			<th role="row">BSgenome</th>
			<td>
				<a href="http://bioconductor.org/packages/BSgenome.Hsapiens.UCSC.hg19/">
					BSgenome.Hsapiens.UCSC.hg19
				</a>
			</td>
		</tr>
		<tr>
			<th role="row">OrganismDb</th>
			<td>
				<a href="http://bioconductor.org/packages/Homo.sapiens/">Homo.sapiens</a>
			</td>
		</tr>
		<tr>
			<th role="row">AnnotationHub</th>
			<td>
				<a href="http://bioconductor.org/packages/AnnotationHub/">AnnotationHub</a>
			</td>
		</tr>
		</tbody>
		</table>
		<div class="citation">
			<p>Ref: Bioconductor workflow &ndash; <a href="https://www.bioconductor.org/help/workflows/annotation/Annotation_Resources/">Annotation Resources</a>.</p>
		</div>
		<p>Bioconductor contains hundreds of these <mark>AnnotationData</mark> packages.</p>
	</section>

	<section class="slide">
		<h2>AnnotationData packages</h2>
		<ul>
			<li>Annotations <strong>standardize a way</strong> to compare their results with others</li>
			<li>Mappings exists to help <strong>convert between different standards</strong></li>
				<ul>
					<li>Find a gene's protein product</li>
					<li>Obtain a transcript all exons' DNA sequences</li>
					<li>Convert gene symbol to its Entrez Gene ID, and to its Ensebml gene ID</li>
					<li>Update results mapped on a older reference to the latest one</li>
				</ul>
			<li>Those data are <strong>stored as databases</strong> (technically, SQLite3 database files)</li>
			<li>They share <strong>similar APIs</strong></li>
		</ul>
	</section>

	<section id="ph525x-annotation-vis" class="slide">
		<h2>What can these sources provide?</h2>
		<p>We can use these annotation sources to act as a simple genome browser. Here we use Bioconductor to show <mark>gene GAPDH in human genome hg19</mark>.</p>
		<div class="citation">
		<pre class="language-r">
<code>devtools::install_github("genomicsclass/ph525x")
biocLite("Gviz")  # Gviz for plotting genomic data
library(ph525x)  # Provides handy helper functions

modPlot("GAPDH", collapse=FALSE, useGeneSym=FALSE)</code>
		</pre>
<p>Ref: <a href="http://genomicsclass.github.io/book/pages/annoPhen.html">Annotating phenotypes and molecular function</a> from PH525x series</p>
		</div>
	</section>

	<section id="ph525-annotation-vis-gapdh" class="slide no-number">
		<img class="cover w" src="pics/modPlot_GAPDH.png" alt="">
	</section>

	<section id="ph525-annotation-vis-mapk1" class="slide no-number">
		<img class="cover w" src="pics/modPlot_mapk1.png" alt="">
	</section>

	<section id="ph525-annotation-vis-interp" class="slide">
		<h2>From the plot, Bioconductor can</h2>
		<ul>
			<li>Know the gene's <strong>genomic location</strong> (e.g. chromosome, region, and strand)</li>
			<li>Know multiple transcript forms and their <strong>UCSC knownGene IDs</strong></li>
			<li>Know the <strong>transcript structure</strong> (e.g. exons, introns, 3' UTR, and 5' UTR)</li>
		</ul>
		<p>Behind the scene, <code>modPlot(...)</code> did a lot of queries. Let's find out how to extract this information ourselves using the annotation related API.</p>
		<p class="note">Plot is made by Gviz. Though we are not able to introduce it today.</p>
	</section>

	<!-- OrgDb -->
	<section class="slide">
		<h2 class="shout">orgDb</h2>
	</section>

	<section class="slide">
		<h2>OrgDb objects</h2>
		<ul>
			<li>OrgDb objects contains gene-based information</li>
			<li>Useful to convert between different IDs, e.g. symbols, gene IDs, and names</li>
			<li>We give more introduction about how to query OrgDb objects, but the usage can be applied to TxDb, BSgenome, OrganismDb, and many</li>
			<li>Common usages:</li>
			<ul>
				<li><code>columns()</code>, <code>keytypes()</code>, <code>keys()</code></li>
				<li><code>select()</code>, <code>mapIds()</code></li>
			</ul>
		</ul>
	</section>

	<section id="orgdb-meta" class="slide tighter">
		<pre class="language-r small">
	<code>> human
OrgDb object:
| DBSCHEMAVERSION: 2.1
| Db type: OrgDb
| Supporting package: AnnotationDbi
| DBSCHEMA: HUMAN_DB
| ORGANISM: Homo sapiens
| SPECIES: Human
| EGSOURCEDATE: 2016-Mar14
| EGSOURCENAME: Entrez Gene
| EGSOURCEURL: ftp://ftp.ncbi.nlm.nih.gov/gene/DATA
| <mark>CENTRALID: EG</mark>
| TAXID: 9606
| GOSOURCENAME: Gene Ontology
| GOSOURCEURL: ftp://ftp.geneontology.org/pub/go/godatabase/archive/latest-lite/
| GOSOURCEDATE: 20160305
| GOEGSOURCEDATE: 2016-Mar14
| GOEGSOURCENAME: Entrez Gene
| GOEGSOURCEURL: ftp://ftp.ncbi.nlm.nih.gov/gene/DATA
| KEGGSOURCENAME: KEGG GENOME
| KEGGSOURCEURL: ftp://ftp.genome.jp/pub/kegg/genomes
| KEGGSOURCEDATE: 2011-Mar15
| GPSOURCENAME: UCSC Genome Bioinformatics (Homo sapiens)
| GPSOURCEURL: ftp://hgdownload.cse.ucsc.edu/goldenPath/hg19
| GPSOURCEDATE: 2010-Mar22
| ENSOURCEDATE: 2016-Mar9
| ENSOURCENAME: Ensembl
| ENSOURCEURL: ftp://ftp.ensembl.org/pub/current_fasta
| UPSOURCENAME: Uniprot
| UPSOURCEURL: http://www.UniProt.org/
| UPSOURCEDATE: Wed Mar 23 15:50:09 2016</code>
		</pre>
		<div class="sidenote">
			<p>Many metadata about each annotation's original source and last update date can be found here.</p>
		</div>
		<style>
			#orgdb-meta .sidenote {
				width: 15em;
				right: 100px;
				top: 52px;
			}
		</style>
	</section>

	<section class="slide">
		<h2>Human's OrgDb</h2>
		<pre class="language-r">
<code>library(org.Hs.eg.db)
human <- org.Hs.eg.db
columns(human)  # shows all available columns
# "ACCNUM"   "ALIAS"  "ENSEMBL"  "ENSEMBLPROT" "ENSEMBLTRANS"
# "ENTREZID" "ENZYME" "EVIDENCE" "EVIDENCEALL" "GENENAME"
# "GO" "GOALL" "IPI"  "MAP" "OMIM" "ONTOLOGY"  "ONTOLOGYALL" ...
</code>
		</pre>
		<p>org.Hs.eg.db's "eg" means data come from NCBI Entrez Gene. Info about each column can be found by <code>help("ENSEMBL")</code></p>
	</section>

	<section class="slide">
		<h2>OrgDb usage (cont'd)</h2>
		</pre>
		<ul>
			<li>Among all columns, some columns contain distinct values, such as gene ID (ENTREZID)</li>
			<li>Called <strong>keytype</strong>. Keytypes can identify a unique record, which can be further mapped to differnt annotations.</li>
			<li>Find all keytypes by <code>keytypes(orgDb)</code>.</li>
		</ul>
	</section>

	<section class="slide">
		<p><code>keys()</code> return values of the given column.</p>
		<pre class="language-r">
<code>head(keys(human, "SYMBOL"))  # [1] "A1BG" "A2M" "A2MP1" ...

# Passed a pattern to filter the returned symbols
keys(human, keytype="SYMBOL", pattern="MAPK")
# [1] "MAPK14" "MAPK1" "MAPK3" "MAPK4" "MAPK6" "MAPK7" ...
# Accept regex as well
keys(human, keytype="SYMBOL", pattern="^MAPK[[:digit:]]{2}$")
# [1] "MAPK14" "MAPK11" "MAPK10" "MAPK13" "MAPK12" "MAPK15"</code>
		</pre>
	</section>

	<section class="slide">
		<h2>Use keytype to query on other columns</h2>
		<p><code>select()</code> connects different columns. Say, what are the Entrez Gene IDs and their full name for MAPK gene family?</p>
		<pre class="language-r">
<code>select(
    human,
    keys = c("MAPK1", "MAPK3", "MAPK6"),
    keytype = "SYMBOL",
    columns = c("ENTREZID", "GENENAME")
)</code>
		</pre>
	</section>

	<section class="slide">
		<h2>Query result</h2>
		<pre class="language-r">
<code># select(...) from the last page
# 'select()' returned <mark>1:1 mapping</mark> between keys and columns
  SYMBOL ENTREZID                           GENENAME
1  MAPK1     5594 mitogen-activated protein kinase 1
2  MAPK3     5595 mitogen-activated protein kinase 3
3  MAPK6     5597 mitogen-activated protein kinase 6</code>
		</pre>

		<p>How does these functions interact with the underlying database?</p>
	</section>

<section class="slide tighter no-number">
	<pre class="language-sql">
<code>-- Get SQLite3 database filepath by `dbfile(org.Hs.eg.db)`
sqlite> SELECT symbol, gene_id AS entrez_id, gene_name
   ...> FROM genes JOIN (
   ...>     SELECT * FROM gene_info
   ...>     WHERE symbol IN ("MAPK1", "MAPK3", "MAPK6")
   ...> ) AS symbol_info
   ...> ON genes._id = symbol_info._id;
symbol	entrez_id	gene_name
MAPK1	5594		mitogen-activated protein kinase 1
MAPK3	5595		mitogen-activated protein kinase 3
MAPK6	5597		mitogen-activated protein kinase 6</code>
	</pre>
</section>

	<section class="slide twocol">
		<h2>When query has 1+ result mappings</h2>
		<div class="left">
			<p>For example, <strong>find all RefSeq IDs</strong> for these MAPK-family genes.</p>
			<pre class="language-r">
<code>select(
    human,
    keys = MAPKS,
    keytype = "SYMBOL",
    columns = c("REFSEQ")
)
</code>
			</pre>
		</div>
		<div class="right">
			<pre class="language-r">
<code># 'select()' returned 1:many ...
   SYMBOL       REFSEQ
1   MAPK1    NM_002745
2   MAPK1    NM_138957
3   MAPK1    NP_002736
4   MAPK1    NP_620407
5   MAPK3 NM_001040056
6   MAPK3 NM_001109891
# ...</code>
			</pre>
		</div>
	</section>

	<section class="slide tighter twocol">
		<h2>Group multiple mapping</h2>
		<p>Use <code>mapIds(multiVals="list")</code>, which returns a list-like structure grouped by having the same key (here is SYMBOL).</p>
		<div class="left">
			<pre class="language-r">
<code>refseq_ids <- mapIds(
    human,
    keys = MAPKS,
    keytype = "SYMBOL",
    column = "REFSEQ",
    multiVals = "list"
)</code>
			</pre>
		</div>
		<div class="right">
			<pre class="language-r">
<code>$MAPK1
[1] "NM_002745" "NM_138957" ...
$MAPK3
[1] "NM_001040056" "NM_001109891"
$MAPK6
[1] "NM_002748" "NP_002739" ...
# ...</code>
			</pre>
		</div>
	</section>

	<section class="slide tighter">
		<pre class="language-r">
<code>mapk_refseq_ids$MAPK1  # operate exactly as a list
# [1] "NM_002745" "NM_138957" "NP_002736" "NP_620407"

# select only transcript IDs (starting with "NM_")
lapply(
    mapk_refseq_ids,
	function(ids) grep("^NM_", ids, value = TRUE)
)
# $MAPK1
# [1] "NM_002745" "NM_138957"
# $MAPK3
# [1] "NM_001040056" "NM_001109891" "NM_002746" ... </code>
		</pre>
	</section>

	<!-- txDb -->
	<section class="slide">
		<h2 class="shout">TxDb</h2>
	</section>

	<section class="slide">
		<h2>TxDb objects</h2>
		<ul>
			<li>TxDb objects contains transcriptome, that is, <strong>representation of transcripts as genomic regions</strong></li>
			<li>Support previous described columns(), keys(), select(), mapIds() functions</li>
			<li>Need special R data structure to <strong>represent set of genomic locations</strong> (e.g. exons, introns, and UTRs) of a trancript. So TxDb objects have <strong>specialized methods</strong></li>
			<li>For human hg19, Bioconuctor ships TxDb.Hsapiens.UCSC.hg19.knownGene, a TxDb object based on <strong>UCSC KnownGene IDs</strong></li>
		</ul>
	</section>

	<section class="slide">
		<pre class="language-r">
<code>library(TxDb.Hsapiens.UCSC.hg19.knownGene)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
keytypes(txdb)
# [1] "CDSID" "CDSNAME" "EXONID" "EXONNAME" "GENEID"
# [6] "TXID" "TXNAME"
columns(txdb)
#  [1] "CDSCHROM" "CDSEND" "CDSID" "CDSNAME" "CDSSTART"
#  [6] "CDSSTRAND" "EXONCHROM" "EXONEND" "EXONID" "EXONNAME"
# [11] "EXONRANK" "EXONSTART" "EXONSTRAND" "GENEID" "TXCHROM"
# [16] "TXEND" "TXID" "TXNAME" "TXSTART" "TXSTRAND" "TXTYPE"
</code>
		</pre>
	</section>

	<section class="slide tighter">
		<p><code>transcripts(txdb)</code> returns all transcript records (in <strong>GRanges</strong>).</p>
		<pre class="language-r medium">
<code>txs <- transcripts(txdb); txs
# GRanges object with 82960 ranges and 2 metadata columns:
#                 seqnames           ranges strand |     tx_id     tx_name
#                    &lt;Rle&gt;        &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt; &lt;character&gt;
#       [1]           chr1 [ 11874,  14409]      + |         1  uc001aaa.3
#       [2]           chr1 [ 11874,  14409]      + |         2  uc010nxq.1
#       [3]           chr1 [ 11874,  14409]      + |         3  uc010nxr.1
#       [4]           chr1 [ 69091,  70008]      + |         4  uc001aal.1
#       [5]           chr1 [321084, 321115]      + |         5  uc001aaq.2
#       ...            ...              ...    ... .       ...         ...
#   [82956] chrUn_gl000237   [    1,  2686]      - |     82956  uc011mgu.1
#   [82957] chrUn_gl000241   [20433, 36875]      - |     82957  uc011mgv.2
#   [82958] chrUn_gl000243   [11501, 11530]      + |     82958  uc011mgw.1
#   [82959] chrUn_gl000243   [13608, 13637]      + |     82959  uc022brq.1
#   [82960] chrUn_gl000247   [ 5787,  5816]      - |     82960  uc022brr.1
#   -------
#   seqinfo: 93 sequences (1 circular) from hg19 genome
</code>
		</pre>
	</section>

	<section class="slide tighter">
		<p>Similar extractor functions exist for <code>genes()</code>, <code>exons()</code>, <code>cds()</code>.</p>
		<pre class="language-r medium">
<code>genes <- genes(txdb); genes
# GRanges object with 23056 ranges and 1 metadata column:
#         seqnames                 ranges strand |     gene_id
#            &lt;Rle&gt;              &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;
#       1    chr19 [ 58858172,  58874214]      - |           1
#      10     chr8 [ 18248755,  18258723]      + |          10
#     100    chr20 [ 43248163,  43280376]      - |         100
#    1000    chr18 [ 25530930,  25757445]      - |        1000
#   10000     chr1 [243651535, 244006886]      - |       10000
#     ...      ...                    ...    ... .         ...
#    9991     chr9 [114979995, 115095944]      - |        9991
#    9992    chr21 [ 35736323,  35743440]      + |        9992
#    9993    chr22 [ 19023795,  19109967]      - |        9993
#    9994     chr6 [ 90539619,  90584155]      + |        9994
#    9997    chr22 [ 50961997,  50964905]      - |        9997
#   -------
#   seqinfo: 93 sequences (1 circular) from hg19 genome</code>
		</pre>
	</section>

	<section class="slide">
		<p>Can subset the GRanges object via the row id (gene_id).</p>
		<pre class="language-r">
<code>genes[c("5594", "5595")]
# GRanges object with 2 ranges and 1 metadata column:
#        seqnames               ranges strand |     gene_id
#           &lt;Rle&gt;            &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;
#   5594    chr22 [22113947, 22221970]      - |        5594
#   5595    chr16 [30125426, 30134630]      - |        5595
#   -------
#   seqinfo: 93 sequences (1 circular) from hg19 genome</code>
		</pre>
	</section>

	<section id="transcriptby" class="slide">
		<h2>Group transcripts</h2>
		<p>How to find transcripts of a gene? How to know the extrons, UTRs of a transcripts?</p>
		<ul>
			<li><code>transcriptsBy(txdb, by = "gene")</code></li>
			<li><code>exonsBy(txdb, by = "tx", use.names = TRUE)</code></li>
			<li>There are more grouper functions such as intronsByTranscript(), fiveUTRsByTranscript(), and threeUTRsByTranscript(). Refer to help page for their usage.</li>
		</ul>
	</section>

	<section class="slide">
		<pre class="language-r medium">
<code>txby <- transcriptsBy(txdb, by="gene"); txby
# <mark>GRangesList</mark> object of length 23459:
# <mark>$1</mark>
# GRanges object with 2 ranges and 2 metadata columns:
#       seqnames               ranges strand |     tx_id     tx_name
#          &lt;Rle&gt;            &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt; &lt;character&gt;
#   [1]    chr19 [58858172, 58864865]      - |     70455  uc002qsd.4
#   [2]    chr19 [58859832, 58874214]      - |     70456  uc002qsf.2
#
# <mark>$10</mark>
# GRanges object with 1 range and 2 metadata columns:
#       seqnames               ranges strand | tx_id    tx_name
#   [1]     chr8 [18248755, 18258723]      + | 31944 uc003wyw.1
#
# ...
# <23456 more elements>
# -------
# seqinfo: 93 sequences (1 circular) from hg19 genome</code>
		</pre>
	</section>

	<section class="slide">
		<p><code>transcriptsBy()</code> returns a <strong>GRangesList</strong>, whose keys are gene IDs (Entrez). Select MAPK1's transcripts and verify with what we found in OrgDb.</p>
		<pre class="language-r medium">
<code>txby[[5594]]
# GRanges object with 3 ranges and 2 metadata columns:
#       seqnames               ranges strand |     tx_id     tx_name
#          &lt;Rle&gt;            &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt; &lt;character&gt;
#   [1]    chr15 [41474931, 41482568]      - |     55602  uc001znj.3
#   [2]    chr15 [41474931, 41522895]      - |     55603  uc001znk.3
#   [3]    chr15 [41474931, 41522895]      - |     55604  uc010ucv.2
#   -------
#   seqinfo: 93 sequences (1 circular) from hg19 genome</code>
		</pre>
		<p>Why we know the gene IDs are Entrez Gene IDs? (try printing txdb itself)</p>
	</section>

	<section class="slide tighter">
		<pre class="language-r medium">
<code>exonsBy(txdb, by = "tx", use.names = TRUE)
# GRangesList object of length 82960:
# $uc001aaa.3
# GRanges object with 3 ranges and 3 metadata columns:
#       seqnames         ranges strand |   exon_id   exon_name exon_rank
#          &lt;Rle&gt;      &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt; &lt;character&gt; &lt;integer&gt;
#   [1]     chr1 [11874, 12227]      + |         1        &lt;NA&gt;         1
#   [2]     chr1 [12613, 12721]      + |         3        &lt;NA&gt;         2
#   [3]     chr1 [13221, 14409]      + |         5        &lt;NA&gt;         3
#
# $uc010nxq.1
# GRanges object with 3 ranges and 3 metadata columns:
#       seqnames         ranges strand | exon_id exon_name exon_rank
#   [1]     chr1 [11874, 12227]      + |       1      &lt;NA&gt;         1
#   [2]     chr1 [12595, 12721]      + |       2      &lt;NA&gt;         2
#   [3]     chr1 [13403, 14409]      + |       6      &lt;NA&gt;         3
#
# ...
# <82957 more elements>
# -------
# seqinfo: 93 sequences (1 circular) from hg19 genome</code>
		</pre>
	</section>

	<section class="slide" id="seqinfo">
		<h2>Extract chromosome information</h2>
		<p>Extract the chromosome information by <code>seqinfo()</code>, returning a <strong>Seqinfo</strong> object. Works on all GRanges objects.</p>
	<pre class="language-r medium">
<code>si <- seqinfo(txdb); si
# Seqinfo object with 93 sequences (1 circular) from hg19 genome:
#   <mark>seqnames       seqlengths isCircular genome</mark>
#   chr1            249250621       &lt;NA&gt;   hg19
#   chr2            243199373       &lt;NA&gt;   hg19
#   chr3            198022430       &lt;NA&gt;   hg19
#   ...                   ...        ...    ...
#   chrUn_gl000247      36422       &lt;NA&gt;   hg19
#   chrUn_gl000248      39786       &lt;NA&gt;   hg19
#   chrUn_gl000249      38502       &lt;NA&gt;   hg19
</code>
	</pre>
	</section>

	<section class="slide">
		<h2>Seqinfo object operations</h2>
		<pre class="language-r">
<code>seqnames(si)  # use its column name as function
# [1] "chr1" "chr2" "chr3" "chr4" "chr5" ...
seqlengths(si)
#      chr1      chr2      chr3      chr4      chr5 ...
# 249250621 243199373 198022430 191154276 180915260 ...
isCircular(si)
# chr1 chr2 chr3 chr4 chr5 ... chrM ...
#   NA   NA   NA   NA   NA ... TRUE ...
		</code></pre>
	</section>

	<section class="slide tighter">
		<h2>Change chromsome naming styles</h2>
		<p>For example, Ensembl uses NCBI style naming (1, 2, ...); UCSC prefix all chromosome names with "chr".</p>

		<pre class="language-r">
<code>seqlevels(txdb)
# [1] "chr1" "chr2" "chr3" "chr4" "chr5" "chr6" ...
seqlevelsStyle(txdb)
# [1] "UCSC"
seqlevelsStyle(txdb) <- "NCBI"  # change the naming style
seqlevels(txdb)
# [1] "1" "2" "3" "4" "5" "6" ...
</code>
		</pre>
	</section>

	<!-- OrganismDb -->
	<section class="slide">
		<h2 class="shout">OrganismDb</h2>
	</section>

	<!-- BSgenome -->
	<section class="slide">
		<h2 class="shout">BSgenome</h2>
	</section>

	<!-- Human OrganismDb example -->
	<section class="slide tighter">
		<pre class="language-r">
	<code>> Homo.sapiens
OrganismDb Object:
# Includes GODb Object:  GO.db
# With data about:  Gene Ontology
# Includes OrgDb Object:  org.Hs.eg.db
# Gene data about:  Homo sapiens
# Taxonomy Id:  9606
# Includes TxDb Object:  TxDb.Hsapiens.UCSC.hg19.knownGene
# Transcriptome data about:  Homo sapiens
# Based on genome:  hg19
# The <mark>OrgDb gene id ENTREZID</mark> is mapped to
# the <mark>TxDb gene id GENEID</mark> .</code>
		</pre>
	</section>


	<!-- Genomic Ranges -->

	<!-- Using BioMart -->
	<!--
	Refseq mRNA to Ensembl transcript ID
	https://www.biostars.org/p/106470/#106534
	https://www.biostars.org/p/102462/#102480
	-->

	<!-- Lift Over example: hg38 to hg19 -->
	<!--
	http://genomicsclass.github.io/book/pages/bioc1_liftOver.html
	-->

	<section id="things-without-time-to-mention" class="slide">
		<h2>Topics I don't have time to say today</h2>
		<ul class="double">
			<li>AnnotationHub</li>
			<li>TxDb's isActiveSeq()</li>
		</ul>
	</section>

	<!-- End Slide -->
	<section id='end' class='slide no-number'>
		<h2>?</h2>
		<img src="pics/end.jpg" class="cover w" alt="">
		<style>
			#end h2 {
				position: absolute;
				left: 52%;
				top: 42%;
				color: rgb(228, 74, 33);
				text-align: right;
				text-shadow: none;
				font-size: 120px;
			}
		</style>
	</section>

	<!-- Section: About me and my future school WUSTL -->
	<section id="about-me" class="slide no-number twocol l60">
		<div class="left">
			<h2>About Me</h2>
			<ul>
				<li>亮亮 or Liang<sup>2</sup></li>
				<li>Master student in Bioinformatics, National Taiwan University (NTU BEBI)</li>
				<li>Former intern at Microsoft Research Asia (MSRA) and Pinkoi</li>
				<li>A PhD student in <a href="http://dbbs.wustl.edu/divprograms/compbio/Pages/default.aspx" target="_blank">WUSTL (WashU)</a> by Fall</li>
				<li>Happy to talk about Bioinfo, anime, and <a href="https://www.ptt.cc/bbs/studyabroad/M.1462818195.A.882.html">my PhD application</a></li>
			</ul>
		</div>
		<div class="right">
			<div class="citation">
			<img class="fill w" src="pics/me.jpg" alt="">
			<p>(Yap, I know I haven't changed my protrait photo since <a href="https://blog.liang2.tw/2014-pyR-stat/" target="_blank">2014</a> and actually the photo I put in <a href="https://blog.liang2.tw/ggplot2-tutorial/201307_slides/#/1">2013</a> is newer)</p>
			</div>
		</div>
	</section>

	<section class="slide" id="problem-solved">
		<!--
		<video class="place" loop autoplay>
		  <source src="https://i.imgur.com/kuT9BZR.webm" type="video/webm">
		  Your browser doesn't support HTML5 video tag.
		</video>
		-->
	</section>

	<!-- END OF SLIDE CONTENT -->
	<p class="badge">
		<a href="https://github.com/ccwang002/2016Talk-Genomics-in-R" target="_blank">Sources on GitHub</a>
	</p>
	<!--
	To hide progress bar from entire presentation
	just remove “progress” element.
	-->
	<div class="progress"></div>

	<!-- Library -->
	<script src="lib/shower/shower.min.js"></script>
	<script src="lib/highlight/highlight.pack.js" type="text/javascript" charset="utf-8"></script>
	<script>
		hljs.initHighlightingOnLoad();
	</script>
	<!-- Mathjax -->
	<!-- online Mathjax CDN -->
	<!--<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>-->
</body>
</html>
